'use strict';

var WiFiScanner = require('./scanners/wifiscanner');
var darwinparser = require('./parsers/darwinparser');
var linuxparser = require('./parsers/linuxparser');
var windowsparser = require('./parsers/windowsparser');
var nconf = require("nconf");

function platformSelect(options) {
    var platform = void 0;
    if (options && options.platform) {
        platform = options.platform;
        delete options.platform;
    }
    return platform || process.platform;
}

function scanner(options) {
    options = options || {};
    var platform = platformSelect(options);
    nconf.file(__dirname + '/config/' + platform + '.json');

    var parser = void 0;
    switch (platform) {
        case "linux":
            parser = linuxparser;
            break;
        case "darwin":
            parser = darwinparser;
            break;
        case "win32":
            parser = windowsparser;
            break;
    }

    var scannerOptions = {
        binaryPath: options.binaryPath || nconf.get("binaryPath"),
        args: options.args || nconf.get("args")
    };
    return new WiFiScanner(scannerOptions, parser);
};

module.exports = scanner;